{"ast":null,"code":"import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport { withExtraArgument } from 'redux-thunk';\nimport { composeWithDevTools } from '@redux-devtools/extension';\nimport * as reducers from './reducers';\nimport * as actionCreators from './actions';\nimport * as tweets from '../pages/tweets/service';\nimport * as auth from '../pages/auth/service';\nconst composeEnhancers = composeWithDevTools({\n  actionCreators\n});\n\n// const thunk = extraArgument => store => next => action => {\n//   if (typeof action === 'function') {\n//     return action(store.dispatch, store.getState, extraArgument);\n//   }\n//   next(action);\n// };\n\nconst logger = store => next => action => {\n  console.group(action.type);\n  console.info('dispatching', action, store.getState());\n  const result = next(action);\n  console.log('final state', store.getState());\n  console.groupEnd();\n  return result;\n};\nconst noAction = () => next => action => {\n  if (action.type.endsWith('/no-throw')) {\n    return;\n  }\n  return next(action);\n};\nconst timestamp = () => next => action => {\n  return next({\n    ...action,\n    meta: {\n      ...action.meta,\n      timestamp: new Date()\n    }\n  });\n};\nconst failureRedirects = (router, redirectsMap) => store => next => action => {\n  const result = next(action);\n  if (action.error) {\n    const redirect = redirectsMap[action.payload.status];\n    if (redirect) {\n      router.navigate(redirect);\n    }\n  }\n  return result;\n};\nconst historyReducer = reducer => {\n  return function (state, action) {\n    const {\n      history,\n      ...restState\n    } = state;\n    if (action.type === 'history/back') {\n      return {\n        ...history.last,\n        history: {\n          last: null,\n          current: history.last\n        }\n      };\n    }\n    const newState = reducer(restState, action);\n    return {\n      ...newState,\n      history: {\n        last: restState,\n        current: newState\n      }\n    };\n  };\n};\nconst rootReducer = historyReducer(combineReducers(reducers));\nexport default function configureStore(preloadedState, {\n  router\n}) {\n  const middleware = [withExtraArgument({\n    api: {\n      auth,\n      tweets\n    },\n    router\n  }), timestamp, failureRedirects(router, {\n    401: '/login',\n    404: '/404'\n  }), logger, noAction];\n  const store = createStore(rootReducer, preloadedState, composeEnhancers(applyMiddleware(...middleware))\n  // window.__REDUX_DEVTOOLS_EXTENSION__ &&\n  //   window.__REDUX_DEVTOOLS_EXTENSION__(),\n  );\n\n  return store;\n}","map":{"version":3,"names":["createStore","combineReducers","applyMiddleware","withExtraArgument","composeWithDevTools","reducers","actionCreators","tweets","auth","composeEnhancers","logger","store","next","action","console","group","type","info","getState","result","log","groupEnd","noAction","endsWith","timestamp","meta","Date","failureRedirects","router","redirectsMap","error","redirect","payload","status","navigate","historyReducer","reducer","state","history","restState","last","current","newState","rootReducer","configureStore","preloadedState","middleware","api"],"sources":["/Users/alex/Desktop/KEEPKODING/REACT_AVANZADO/GIT/FullStack07_React_app_tweeter_REDUX_/src/store/index.js"],"sourcesContent":["import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport { withExtraArgument } from 'redux-thunk';\nimport { composeWithDevTools } from '@redux-devtools/extension';\n\nimport * as reducers from './reducers';\nimport * as actionCreators from './actions';\n\nimport * as tweets from '../pages/tweets/service';\nimport * as auth from '../pages/auth/service';\n\nconst composeEnhancers = composeWithDevTools({ actionCreators });\n\n// const thunk = extraArgument => store => next => action => {\n//   if (typeof action === 'function') {\n//     return action(store.dispatch, store.getState, extraArgument);\n//   }\n//   next(action);\n// };\n\nconst logger = store => next => action => {\n  console.group(action.type);\n  console.info('dispatching', action, store.getState());\n  const result = next(action);\n  console.log('final state', store.getState());\n  console.groupEnd();\n  return result;\n};\n\nconst noAction = () => next => action => {\n  if (action.type.endsWith('/no-throw')) {\n    return;\n  }\n  return next(action);\n};\n\nconst timestamp = () => next => action => {\n  return next({\n    ...action,\n    meta: { ...action.meta, timestamp: new Date() },\n  });\n};\n\nconst failureRedirects = (router, redirectsMap) => store => next => action => {\n  const result = next(action);\n\n  if (action.error) {\n    const redirect = redirectsMap[action.payload.status];\n    if (redirect) {\n      router.navigate(redirect);\n    }\n  }\n\n  return result;\n};\n\nconst historyReducer = reducer => {\n  return function (state, action) {\n    const { history, ...restState } = state;\n\n    if (action.type === 'history/back') {\n      return {\n        ...history.last,\n        history: {\n          last: null,\n          current: history.last,\n        },\n      };\n    }\n\n    const newState = reducer(restState, action);\n    return {\n      ...newState,\n      history: {\n        last: restState,\n        current: newState,\n      },\n    };\n  };\n};\n\nconst rootReducer = historyReducer(combineReducers(reducers));\n\nexport default function configureStore(preloadedState, { router }) {\n  const middleware = [\n    withExtraArgument({ api: { auth, tweets }, router }),\n    timestamp,\n    failureRedirects(router, { 401: '/login', 404: '/404' }),\n    logger,\n    noAction,\n  ];\n  const store = createStore(\n    rootReducer,\n    preloadedState,\n    composeEnhancers(applyMiddleware(...middleware)),\n    // window.__REDUX_DEVTOOLS_EXTENSION__ &&\n    //   window.__REDUX_DEVTOOLS_EXTENSION__(),\n  );\n  return store;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}